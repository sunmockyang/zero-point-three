function BackgroundMedia(e,i){this.articleContainer=e.articleContainer,this.title1=e.title1,this.title2=e.title2,this.titleContainer=e.titleContainer,this.video1=e.video1,this.video2=e.video2,this.videoContainer=e.videoContainer,this.videoOverlay=e.videoOverlay,this.currentVideo=this.video1,this.introParagraph=e.introParagraph,e.introDownCaret.onclick=function(){window.pageYOffset<this.transitionPercentage*BackgroundMedia.scrollRange?animateScroll(this.transitionPercentage*BackgroundMedia.scrollRange,1500,"easeInOutQuad",-10,"top"):animateScroll(document.getElementById("introStart"),3e3,"easeInOutQuint",.075*document.documentElement.clientHeight,"top")}.bind(this),this.video1TargetVolume=this.maxVolume,this.video2TargetVolume=0,this.video1.volume=this.video2.volume=0,this.videoContainer.classList.remove("hidden"),isIOS()?(this.video1.outerHTML='<div class="image" id="video1"></div>',this.video2.outerHTML='<div class="image" id="video2"></div>',this.video1=document.getElementById("video1"),this.video2=document.getElementById("video2")):(this.playVideo(!0),this.updateVideoVolume()),this.indexBackground=e.indexBackground,this.lastY=0,this.lastYPercentage=0,this.onResize(i)}BackgroundMedia.scrollRange=999,BackgroundMedia.prototype.transitionPercentage=.3,BackgroundMedia.prototype.videoEndPercentage=1.1,BackgroundMedia.prototype.introParagraphStart=-.2,BackgroundMedia.prototype.fadeRange=.25,BackgroundMedia.prototype.fadeEnd=.9,BackgroundMedia.prototype.volumeLerp=.02,BackgroundMedia.prototype.maxVolume=.2,BackgroundMedia.prototype.volumeRequestID=0,BackgroundMedia.prototype.onResize=function(e){BackgroundMedia.scrollRange=e.getHeight(),this.articleContainer.style.marginTop=BackgroundMedia.scrollRange+"px",this.onScroll()},BackgroundMedia.prototype.onScroll=function(e){var i=window.pageYOffset,t=i/BackgroundMedia.scrollRange;OnMarkerCrossed(this.transitionPercentage,this.lastYPercentage,t,this.animateSecondVideoIn.bind(this),this.animateSecondVideoOut.bind(this)),OnMarkerCrossed(this.videoEndPercentage,this.lastYPercentage,t,this.animateVideoOut.bind(this),this.animateVideoIn.bind(this)),OnMarkerCrossed(BackgroundMedia.scrollRange+this.introParagraphStart*document.documentElement.clientHeight,this.lastY,i,show.bind(window,this.introParagraph)),1>t&&setTranslate3dY(this.titleContainer,50*-t);var o=1-(this.fadeEnd-t)/this.fadeRange;if(o>0){var a=Mathx.normalize(1-Math.pow(o,2));this.titleContainer.style.opacity=a,this.video2.style.opacity=a,this.videoOverlay.style.opacity=a,this.volumeLerp=.02,this.video2TargetVolume=a*this.maxVolume}else 1!=this.video2.style.opacity&&(this.titleContainer.style.opacity=1,this.video2.style.opacity=1,this.videoOverlay.style.opacity=1);this.lastY=i,this.lastYPercentage=this.lastY/BackgroundMedia.scrollRange},BackgroundMedia.prototype.animateSecondVideoIn=function(){this.title1.classList.add("second-video"),this.title2.classList.add("second-video"),this.video1.classList.add("second-video"),this.currentVideo=this.video2,this.volumeLerp=.05,this.video1TargetVolume=0,this.video2TargetVolume=this.maxVolume},BackgroundMedia.prototype.animateSecondVideoOut=function(){this.title1.classList.remove("second-video"),this.title2.classList.remove("second-video"),this.video1.classList.remove("second-video"),this.currentVideo=this.video1,this.volumeLerp=.05,this.video1TargetVolume=this.maxVolume,this.video2TargetVolume=0},BackgroundMedia.prototype.updateVideoVolume=function(){(this.video1.volume!=this.video1TargetVolume||this.video2.volume!=this.video2TargetVolume)&&(this.video1.volume=Mathx.Lerp(this.video1.volume,this.video1TargetVolume,this.volumeLerp),this.video2.volume=Mathx.Lerp(this.video2.volume,this.video2TargetVolume,this.volumeLerp)),window.requestAnimationFrame(this.updateVideoVolume.bind(this))},BackgroundMedia.prototype.animateVideoOut=function(){this.playVideo(!1),this.title1.classList.add("hidden"),this.title2.classList.add("hidden"),this.video1.classList.add("hidden"),this.video2.classList.add("hidden"),this.videoContainer.classList.add("hidden"),this.indexBackground.classList.remove("hidden")},BackgroundMedia.prototype.animateVideoIn=function(){this.playVideo(!0),this.title1.classList.remove("hidden"),this.title2.classList.remove("hidden"),this.video1.classList.remove("hidden"),this.video2.classList.remove("hidden"),this.videoContainer.classList.remove("hidden"),this.indexBackground.classList.add("hidden")},BackgroundMedia.prototype.playVideo=function(e){isIOS()||!e||this.playing?isIOS()||e||!this.playing||(this.playing=!1,this.video1.pause(),this.video2.pause()):(this.playing=!0,this.video1.play(),this.video2.play())};